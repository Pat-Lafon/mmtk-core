<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Generic mmap and protection functionality"><meta name="keywords" content="rust, rustlang, rust-lang, Mmapper"><title>Mmapper in mmtk::util::heap::layout::mmapper - Rust</title><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../SourceSerif4-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../FiraSans-Regular.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../FiraSans-Medium.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../SourceCodePro-Regular.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../SourceSerif4-Bold.ttf.woff2"><link rel="preload" as="font" type="font/woff2" crossorigin href="../../../../../SourceCodePro-Semibold.ttf.woff2"><link rel="stylesheet" href="../../../../../normalize.css"><link rel="stylesheet" href="../../../../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" href="../../../../../ayu.css" disabled><link rel="stylesheet" href="../../../../../dark.css" disabled><link rel="stylesheet" href="../../../../../light.css" id="themeStyle"><script id="default-settings" ></script><script src="../../../../../storage.js"></script><script defer src="sidebar-items.js"></script><script defer src="../../../../../main.js"></script><noscript><link rel="stylesheet" href="../../../../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../../../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../../../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../../../../favicon.svg"></head><body class="rustdoc trait"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle">&#9776;</button><a class="sidebar-logo" href="../../../../../mmtk/index.html"><div class="logo-container"><img class="rust-logo" src="../../../../../rust-logo.svg" alt="logo"></div></a><h2></h2></nav><nav class="sidebar"><a class="sidebar-logo" href="../../../../../mmtk/index.html"><div class="logo-container"><img class="rust-logo" src="../../../../../rust-logo.svg" alt="logo"></div></a><h2 class="location"><a href="#">Mmapper</a></h2><div class="sidebar-elems"><section><h3><a href="#required-methods">Required Methods</a></h3><ul class="block"><li><a href="#tymethod.eagerly_mmap_all_spaces">eagerly_mmap_all_spaces</a></li><li><a href="#tymethod.ensure_mapped">ensure_mapped</a></li><li><a href="#tymethod.is_mapped_address">is_mapped_address</a></li><li><a href="#tymethod.mark_as_mapped">mark_as_mapped</a></li><li><a href="#tymethod.protect">protect</a></li><li><a href="#tymethod.quarantine_address_range">quarantine_address_range</a></li></ul><h3><a href="#implementors">Implementors</a></h3></section><h2><a href="index.html">In mmtk::util::heap::layout::mmapper</a></h2></div></nav><main><div class="width-limiter"><nav class="sub"><form class="search-form"><span></span><input class="search-input" name="search" autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"><div id="help-button" title="help" tabindex="-1"><a href="../../../../../help.html">?</a></div><div id="settings-menu" tabindex="-1"><a href="../../../../../settings.html" title="settings"><img width="22" height="22" alt="Change settings" src="../../../../../wheel.svg"></a></div></form></nav><section id="main-content" class="content"><div class="main-heading"><h1 class="fqn">Trait <a href="../../../../index.html">mmtk</a>::<wbr><a href="../../../index.html">util</a>::<wbr><a href="../../index.html">heap</a>::<wbr><a href="../index.html">layout</a>::<wbr><a href="index.html">mmapper</a>::<wbr><a class="trait" href="#">Mmapper</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../../../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></h1><span class="out-of-band"><a class="srclink" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#9-61">source</a> · <a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span></div><div class="item-decl"><pre class="rust trait"><code>pub trait Mmapper {
    fn <a href="#tymethod.eagerly_mmap_all_spaces" class="fnname">eagerly_mmap_all_spaces</a>(&amp;self, space_map: &amp;[<a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>]);
<span class="item-spacer"></span>    fn <a href="#tymethod.mark_as_mapped" class="fnname">mark_as_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, bytes: <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.usize.html">usize</a>);
<span class="item-spacer"></span>    fn <a href="#tymethod.quarantine_address_range" class="fnname">quarantine_address_range</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.usize.html">usize</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.66.1/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.ensure_mapped" class="fnname">ensure_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.usize.html">usize</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.66.1/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.unit.html">()</a>&gt;;
<span class="item-spacer"></span>    fn <a href="#tymethod.is_mapped_address" class="fnname">is_mapped_address</a>(&amp;self, addr: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.bool.html">bool</a>;
<span class="item-spacer"></span>    fn <a href="#tymethod.protect" class="fnname">protect</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.usize.html">usize</a>);
}</code></pre></div><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Generic mmap and protection functionality</p>
</div></details><h2 id="required-methods" class="small-section-header">Required Methods<a href="#required-methods" class="anchor"></a></h2><div class="methods"><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.eagerly_mmap_all_spaces" class="method has-srclink"><a class="srclink rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#16">source</a><h4 class="code-header">fn <a href="#tymethod.eagerly_mmap_all_spaces" class="fnname">eagerly_mmap_all_spaces</a>(&amp;self, space_map: &amp;[<a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>])</h4></section></summary><div class="docblock"><p>Given an address array describing the regions of virtual memory to be used
by MMTk, demand zero map all of them if they are not already mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>spaceMap</code>: An address array containing a pairs of start and end
addresses for each of the regions to be mapped</li>
</ul>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.mark_as_mapped" class="method has-srclink"><a class="srclink rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#25">source</a><h4 class="code-header">fn <a href="#tymethod.mark_as_mapped" class="fnname">mark_as_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, bytes: <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>Mark a number of pages as mapped, without making any
request to the operating system.  Used to mark pages
that the VM has already mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be mapped</li>
<li><code>bytes</code>: Number of bytes to ensure mapped</li>
</ul>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.quarantine_address_range" class="method has-srclink"><a class="srclink rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#34">source</a><h4 class="code-header">fn <a href="#tymethod.quarantine_address_range" class="fnname">quarantine_address_range</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.usize.html">usize</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.66.1/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Quarantine/reserve address range. We mmap from the OS with no reserve and with PROT_NONE,
which should be little overhead. This ensures that we can reserve certain address range that
we can use if needed. Quarantined memory needs to be mapped before it can be used.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be quarantined</li>
<li><code>bytes</code>: Number of bytes to quarantine from the start</li>
</ul>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.ensure_mapped" class="method has-srclink"><a class="srclink rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#46">source</a><h4 class="code-header">fn <a href="#tymethod.ensure_mapped" class="fnname">ensure_mapped</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.usize.html">usize</a>) -&gt; <a class="type" href="https://doc.rust-lang.org/1.66.1/std/io/error/type.Result.html" title="type std::io::error::Result">Result</a>&lt;<a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.unit.html">()</a>&gt;</h4></section></summary><div class="docblock"><p>Ensure that a range of pages is mmapped (or equivalent).  If the
pages are not yet mapped, demand-zero map them. Note that mapping
occurs at chunk granularity, not page granularity.<p></p>
<p>Argumetns:
<code>start</code>: The start of the range to be mapped.
<code>pages</code>: The size of the range to be mapped, in pages</p>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.is_mapped_address" class="method has-srclink"><a class="srclink rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#53">source</a><h4 class="code-header">fn <a href="#tymethod.is_mapped_address" class="fnname">is_mapped_address</a>(&amp;self, addr: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>) -&gt; <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.bool.html">bool</a></h4></section></summary><div class="docblock"><p>Is the page pointed to by this address mapped? Returns true if
the page at the given address is mapped.</p>
<p>Arguments:</p>
<ul>
<li><code>addr</code>: Address in question</li>
</ul>
</div></details><details class="rustdoc-toggle method-toggle" open><summary><section id="tymethod.protect" class="method has-srclink"><a class="srclink rightside" href="../../../../../src/mmtk/util/heap/layout/mmapper.rs.html#60">source</a><h4 class="code-header">fn <a href="#tymethod.protect" class="fnname">protect</a>(&amp;self, start: <a class="struct" href="../../../address/struct.Address.html" title="struct mmtk::util::address::Address">Address</a>, pages: <a class="primitive" href="https://doc.rust-lang.org/1.66.1/std/primitive.usize.html">usize</a>)</h4></section></summary><div class="docblock"><p>Mark a number of pages as inaccessible.</p>
<p>Arguments:</p>
<ul>
<li><code>start</code>: Address of the first page to be protected</li>
<li><code>pages</code>: Number of pages to be protected</li>
</ul>
</div></details></div><h2 id="implementors" class="small-section-header">Implementors<a href="#implementors" class="anchor"></a></h2><div id="implementors-list"><section id="impl-Mmapper-for-FragmentedMapper" class="impl has-srclink"><a class="srclink rightside" href="../../../../../src/mmtk/util/heap/layout/fragmented_mapper.rs.html#60-206">source</a><a href="#impl-Mmapper-for-FragmentedMapper" class="anchor"></a><h3 class="code-header">impl <a class="trait" href="trait.Mmapper.html" title="trait mmtk::util::heap::layout::mmapper::Mmapper">Mmapper</a> for <a class="struct" href="../fragmented_mapper/struct.FragmentedMapper.html" title="struct mmtk::util::heap::layout::fragmented_mapper::FragmentedMapper">FragmentedMapper</a></h3></section></div><script src="../../../../../implementors/mmtk/util/heap/layout/mmapper/trait.Mmapper.js" async></script></section></div></main><div id="rustdoc-vars" data-root-path="../../../../../" data-current-crate="mmtk" data-themes="ayu,dark,light" data-resource-suffix="" data-rustdoc-version="1.66.1 (90743e729 2023-01-10)" ></div></body></html>